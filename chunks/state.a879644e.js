import{G as d,s as h}from"./index.2fd2ec22.js";const u=[];function y(n,r=d){let f;const o=new Set;function e(s){if(h(n,s)&&(n=s,f)){const i=!u.length;for(const t of o)t[1](),u.push(t,n);if(i){for(let t=0;t<u.length;t+=2)u[t][0](u[t+1]);u.length=0}}}function c(s){e(s(n))}function l(s,i=d){const t=[s,i];return o.add(t),o.size===1&&(f=r(e)||d),s(n),()=>{o.delete(t),o.size===0&&(f(),f=null)}}return{set:e,update:c,subscribe:l}}function b(n,r){let f=n,{set:o,...e}=y(n,r);return{set:c=>{f=c,o(c)},get:()=>f,...e}}function w(n){const r=b(n),f=[];let o=!1;if(r.setWithoutHistory=e=>{o=!0,r.set(e),o=!1},r.keepHistory=function(e){f.push(e)},typeof window<"u"){let e={};const c=()=>{const s=new URLSearchParams(window.location.search);for(let[i,t]of s){try{t=JSON.parse(t)}catch{}e[i]=t}r.setWithoutHistory(e)};c(),window.addEventListener("popstate",c);let l=e;r.subscribe(s=>{if(o||typeof history>"u")return;let i="",t=!1;for(const p in s){let a=s[p];i+=i?"&":"?",l[p]!==a&&f.indexOf(p)!==-1&&(t=!0),!(typeof a>"u")&&(!!a&&typeof a=="object"&&(a=JSON.stringify(a)),a=encodeURIComponent(a),i+=p+"="+a)}l=JSON.parse(JSON.stringify(s)),t?history.pushState(history.state,document.title,window.location.pathname+i):history.replaceState(history.state,document.title,window.location.pathname+i)})}return r}const S=w({});export{S as s};
